function s(e,t=0){return d(e,t,2).getUint16(0,!0)}function l(e,t=0){return d(e,t,4).getUint32(0,!0)}function f(e,t=0,i=e.byteLength){let x=e.slice(t,t+i);return L.decode(new Uint8Array(x))}function T(e,t=" "){return R.encode(e)}function k(e,t,i=0){let x=T(t);return m(e,x,i)}function u(e,t,i=0){return k(new Uint8Array(e.slice(i,t.length*8)),t)}function m(e,t,i=0){if(e.length<t.length+i)return!1;for(let[x,n]of t.entries())if(n!==null&&n!==e[x+i])return!1;return!0}function d(e,t,i){let x=e.slice(t,t+i);return new DataView(new Uint8Array(x).buffer)}var L=new TextDecoder("utf8"),R=new TextEncoder;function g(e){let t=i=>u(e,i,8);return t("qt")?{ext:"mov",mime:"video/quicktime"}:t("heic")?{ext:"heic",mime:"image/heic"}:t("avif")?{ext:"avif",mime:"image/avif"}:t("M4V")?{ext:"m4v",mime:"video/x-m4v"}:t("M4A")?{ext:"m4a",mime:"audio/mp4"}:{ext:"mp4",mime:"video/mp4"}}var c=[["db","application/vnd.sqlite3",[83,81,76,105,116,101,32,102,111,114,109,97,116,32,51,0]],["woff","font/woff",[119,79,70,70]],["woff2","font/woff2",[119,79,70,50]],["bmp","image/bmp",[66,77]],["gif","image/gif",[71,73,70,56,55,97]],["gif","image/gif",[71,73,70,56,57,97]],["heic","image/heic",[102,116,121,112,104,101,105],{offset:4}],["heic","image/heic",[102,116,121,112,109],{offset:4}],["ico","image/x-icon",[0,0,1,0]],["jpg","image/jpeg",[255,216,255]],["pdf","application/pdf",[37,80,68,70,45]],["png","image/png",[137,80,78,71,13,10,26,10]],["7z","application/x-7z-compressed",[55,122,188,175,39,28]],["rar","application/x-rar-compressed",[82,97,114,33,26,7,0]],["rar","application/x-rar-compressed",[82,97,114,33,26,7,1,0]],["rtf","application/rtf",[123,92,114,116,102,49]],["bz2","application/x-bzip2",[66,90,104]],["gz","application/gzip",[31,139]],["tar","application/x-tar",[117,115,116,97,114,0,48,48],{offset:257}],["tar","application/x-tar",[117,115,116,97,114,32,32,0],{offset:257}],["tif","image/tiff",[73,73,42,0]],["tiff","image/tiff",[77,77,0,42]],["zip","application/zip",[80,75,3,4],{exact:!1}],["zip","application/zip",[80,75,5,6]],["mp3","audio/mp3",[255,251]],["mp3","audio/mp3",[255,243]],["mp3","audio/mp3",[255,242]],["mp3","audio/mp3",[73,68,51]],["mp4","video/mp4",[102,116,121,112,105,115,111,109],{offset:4}],["avi","video/x-msvideo",[82,73,70,70,null,null,null,null,65,86,73,32]],["wav","audio/wav",[82,73,70,70,null,null,null,null,87,65,86,69]],["ogx","application/ogg",[79,103,103,83],{exact:!1},[["oga","audio/ogg",[127,70,76,65,67],{offset:28}],["ogg","audio/ogg",[1,118,111,114,98,105,115],{offset:28}],["ogm","video/ogg",[1,118,105,100,101,111,0],{offset:28}],["ogv","video/ogg",[128,116,104,101,111,114,97],{offset:28}]]],["webp","image/webp",[82,73,70,70,null,null,null,null,87,69,66,80]],["psd","image/vnd.adobe.photoshop",[56,66,80,83]],["flac","audio/x-flac",[102,76,97,67]],["wasm","application/wasm",[0,97,115,109]],["deb","application/x-deb",[33,60,97,114,99,104,62,10]],["exe","application/x-msdownload",[77,90]],["exe","application/x-msdownload",[90,77]],["class","application/java-vm",[202,254,186,190]],["parquet","application/vnd.apache.parquet",[80,65,82,49]],["mov","video/quicktime",[102,114,101,101],{offset:4}],["mov","video/quicktime",[109,100,97,116],{offset:4}],["mov","video/quicktime",[109,111,111,118],{offset:4}],["mov","video/quicktime",[119,105,100,101],{offset:4}]];function q(e){for(let t=0;t<e.length;t++)try{let i=e.charCodeAt(t);if(i===65533||i<=8)return!1}catch{return!1}return!0}function y(e){try{let t=f(e);if(!q(t))return;try{return JSON.parse(t),{ext:"json",mime:"application/json"}}catch{return{ext:"txt",mime:"text/plain"}}}catch{return}}function v(e){return h(e).map(([t,i,x,{offset:n=0}={}])=>x.length+n).reduce((t,i)=>i>t?i:t,0)}function h(e){return e.flatMap(([t,i,x,n={},r=[]])=>[[t,i,x,n],...r])}function w(e,{ext:t,mime:i}){return t||i?h(e).filter(x=>x[0]===t||x[1]===i):[]}function S(e,t){let i=0;for(;i+30<e.byteLength;){let x=s(e,i+18),n=s(e,i+26),r=s(e,i+28),p=f(e,i+30,n),[o]=p.split("/"),a=p.endsWith(".xml");if(o==="extension.vsixmanifest")return{ext:"vsix",mime:"application/vsix"};if(o==="META-INF")return{ext:"jar",mime:"application/java-archive"};if(o==="ppt"&&a)return{ext:"pptx",mime:"application/vnd.openxmlformats-officedocument.presentationml.presentation"};if(o==="word"&&a)return{ext:"docx",mime:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"};if(o==="xl"&&a)return{ext:"xlsx",mime:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"};if(o==="mimetype")return j(e,n)??t;i=i+30+n+r+x}return t}function j(e,t){let i=l(e,18),x=l(e,22),n=s(e,28);if(i===x){let r=f(e,30+t+n,i);if(r==="application/vnd.oasis.opendocument.presentation")return{ext:"odp",mime:r};if(r==="application/vnd.oasis.opendocument.spreadsheet")return{ext:"ods",mime:r};if(r==="application/vnd.oasis.opendocument.text")return{ext:"odt",mime:r};if(r==="application/epub+zip")return{ext:"epub",mime:r}}}var M=v(c);function b(e,{extra:t=!1,hint:i}={}){if(i){let n=w(c,i);if(n.length>0){let r=B(e,n);if(r!==void 0)return r}}if(u(e,"ftyp",4))return g(e);let x=B(e,c);if(x)return x;if(t)return O(e)}function B(e,t){let i=new Uint8Array(e.slice(0,M));for(let[x,n,r,{exact:p=!0,offset:o=0}={},a=[]]of t)if(m(i,r,o)){if(x==="zip"&&!p)return S(e,{ext:x,mime:n});if(!p&&a.length){for(let[A,U,z,{offset:F=0}={}]of a)if(m(i,z,F))return{ext:A,mime:U}}return{ext:x,mime:n}}}function O(e){return y(e)}export{b as parse};
